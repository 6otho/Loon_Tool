#!name=Spotify歌词翻译
#!desc=通过百度翻译 API 实现歌词汉化，修复新版歌词翻译域名无法触发问题
#!author=6otho [https://github.com/6otho]
#!homepage=https://t.me/PaKo_Ov_Chan
#!icon=https://raw.githubusercontent.com/tugepaopao/Image-Storage/master/cartoon/Cute/spotify.png
#!loon_version=3.3+

[Argument]
appid = input, tag = 百度appid, desc = 此处填写百度appid
securityKey = input, tag = 百度密钥, desc = 此处填写百度密钥

[Rule]
# 拒绝 QUIC，强制走 TCP（可替换为 DOMAIN-SUFFIX 或 DOMAIN-REGEX）
AND, ((DOMAIN-SUFFIX, spclient.spotify.com), (PROTOCOL, QUIC)), REJECT

[Script]
# 拦截 color-lyrics v2 track 请求
http-response ^https://[^/]+\.spotify\.com(:443)?/color-lyrics/v2/track/ requires-body=true, binary-body-mode=true, timeout=10, script-path=https://raw.githubusercontent.com/6otho/Loon_tool/refs/heads/main/Js/Spotify_lyrics.js, argument=[{appid},{securityKey}]

[MITM]
# 建议使用通配符
hostname = *.spotify.com
