#!name=Spotify 歌词翻译
#!desc=通过百度翻译 API 实现歌词汉化，新增域名逻辑
#!loon_version=3.3+

[Argument]
appid=input,tag=百度 AppID,desc=此处填写百度翻译 AppID
securityKey=input,tag=百度密钥,desc=此处填写翻译密钥

[Rule]
# 只拦这 3 个域名，进用户的“默认代理”，不管叫啥都行
DOMAIN-SUFFIX,spclient.wg.spotify.com,PROXY
DOMAIN-SUFFIX,gae2-spclient.spotify.com,PROXY
DOMAIN-SUFFIX,guc3-spclient.spotify.com,PROXY

# 其余流量按你的现有“兜底”走法，不动
FINAL,DIRECT

[Script]
# 正则末尾用 .*，确保带 ? 参数也能抓到
http-response ^https://(?:spclient\.wg|gae2-spclient|guc3-spclient)\.spotify\.com(?::443)?/color-lyrics/v2/track/.* requires-body=true,binary-body-mode=true,timeout=10,script-path=https://raw.githubusercontent.com/6otho/Loon_tool/main/Js/Spotify_lyrics.js,argument=[{appid},{securityKey}]

[MITM]
hostname = spclient.wg.spotify.com, gae2-spclient.spotify.com, guc3-spclient.spotify.com
